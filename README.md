<h1>Scrooge Bot <img alt="logo" src="https://github.com/user-attachments/assets/24d55225-38ac-4fe9-a067-2b0e25af6601" width="60" style="vertical-align: middle;"/></h1>

## ⚠️ Дисклеймер

**ИСПОЛЬЗОВАНИЕ НА СВОЙ СТРАХ И РИСК**

Данное программное обеспечение работает с банковскими данными пользователя и требует понимания принципов компьютерной безопасности. Предоставленный исходный код распространяется исключительно в **образовательных и информационных целях** и не предназначен для коммерческого использования или использования в производственной среде.

Авторы проекта не несут ответственности за любые последствия использования данного программного обеспечения, включая, но не ограничиваясь: утечку данных, несанкционированный доступ к банковским счетам, финансовые потери и блокировку банковского аккаунта.

### Правовые риски

Использование данного программного обеспечения может нарушать условия пользовательского соглашения и договора об оказании банковских услуг, заключённого между пользователем и кредитной организацией, что может повлечь за собой применение санкций со стороны банка, включая: блокировку доступа к интернет-банку, приостановку или расторжение договора банковского обслуживания.

### Требования к использованию

**НЕ ИСПОЛЬЗУЙТЕ ЭТОТ ПРОЕКТ**, если:
- Вы не понимаете исходный код проекта
- Вы не знакомы с основами компьютерной безопасности
- Вы не можете самостоятельно оценить риски использования автоматизации для доступа к банковским данным


## Суть проекта

**Scrooge Bot** — это телеграм-бот для планирования бюджета, который помогает контролировать расходы и достигать финансовых целей. Каждый день бот проверяет баланс в интернет-банке и показывает, сколько можно тратить в среднем, чтобы хватило до конца месяца.
Бот автоматизирует мониторинг финансов и помогает придерживаться бюджета, отправляя ежедневные уведомления о текущем балансе и рекомендуемых тратах.

**Пример сообщения от бота:**
```
Вчера было потрачено 1_525 ₽. Осталось 2_233 ₽ в день.
```

## Как это работает

1. **Бот запускает браузер** и переходит на страницу входа в интернет-банк.

2. **Бот запрашивает учётные данные через Telegram**: логины, пароли и коды СМС. **Все сообщения, которые вы отправляете боту, должны быть зашифрованы с использованием RSA**. Расшифровать отправляемые сообщения сможет только бот, обладающий соответствующим приватным ключом.

3. **Ежедневная проверка баланса**: раз в сутки бот входит в аккаунт, получает текущий баланс и отправляет уведомление в Telegram с информацией о тратах и рекомендуемых расходах до конца месяца.

### Авторизация

При первом запуске бот проходит **двухфакторную авторизацию** (2FA) и запрашивает через Telegram:
- Номер телефона
- Код из СМС
- Пароль (если требуется)

После успешной авторизации бот сохраняет состояние браузера в **оперативной памяти** и использует **однофакторную авторизацию** с доверенного браузера для последующих входов в рамках одной сессии.

⚠️ **Важно**: Состояние браузера хранится только в оперативной памяти. При перезапуске бота потребуется заново проходить двухфакторную авторизацию.

### Шифрование сообщений

**КРИТИЧЕСКИ ВАЖНО**: Все чувствительные данные (логины, пароли, коды СМС) должны передаваться в зашифрованном виде. Для передачи чувствительной информации зашифруйте её публичным ключом RSA PKCS#1 v1.5. Результат передайте в ответном сообщении в формате base64.

**Инструкция по шифрованию:**

1. Скопируйте публичный ключ из сообщения, которое отправит бот
2. Перейдите на https://emn178.github.io/online-tools/rsa/encrypt/
3. Установите параметры:
   - **Output encoding**: base64
   - **Algorithm**: ECB / PKCS#1
   - **Public key**: вставьте ключ из шага 1
4. В поле **Input** введите сообщение, которое хотите передать
5. Полученное значение из поля **Output** отправьте в ответном сообщении боту

**Важно**: Расшифровать отправляемые сообщения сможет только бот, обладающий соответствующим приватным ключом. Это обеспечивает защиту ваших данных даже в случае компрометации Telegram-аккаунта или перехвата сообщений.

## ⚠️ Предупреждение о безопасности

**КРИТИЧЕСКИ ВАЖНО**: Этот бот работает с вашими банковскими данными и требует особой осторожности при использовании.

### Риски безопасности

Бот фактически запускает браузер, в котором заходит в интернет-банк от вашего имени. Это создаёт несколько критических векторов атаки:

1. **Токен телеграм-бота**: Если злоумышленник узнает токен вашего телеграм-бота, он сможет выдать себя за бота и таким образом получить доступ к вашему аккаунту в интернет-банке через механизм авторизации бота.

2. **Компрометация машины**: Если злоумышленник получит контроль над машиной, на которой запущен бот, или сможет модифицировать код бота, он получит полный доступ к вашему интернет-банку.

### Обязательные меры предосторожности

Перед использованием бота **обязательно** выполните следующие действия:

- **Запускайте бота только на доверенных машинах**: используйте машины с ограниченным доступом, где только вы имеете физический и удалённый доступ.

- **Защитите токен бота**: убедитесь, что никто не может получить доступ к токену вашего телеграм-бота. Не храните его в публичных репозиториях и не передавайте третьим лицам.

- **Удаляйте сообщения с учётными данными**: сразу после прохождения авторизации удаляйте из истории чата с ботом все сообщения, содержащие логины, пароли и коды доступа.

- **Проверяйте инициацию входа**: при проходе 2FA убедитесь, просматривая логи, что это именно ваш бот инициализирует вход, а не злоумышленник, получивший доступ к токену.

## TODO

- [ ] Добавить поддержу других банков

## Установка и запуск

### Предварительные требования

- Docker и Docker Compose
- Git

### Шаги установки

1. **Клонируйте репозиторий**:
```bash
git clone <repository-url>
cd scrooge-bot
```

2. **Создайте файл с переменными окружения**:
```bash
cp .environment.example .environment
```

3. **Отредактируйте `.environment`** и заполните необходимые переменные:
   - `TELEGRAM_BOT_TOKEN` — токен вашего Telegram-бота (получите у [@BotFather](https://t.me/BotFather))
   - `TELEGRAM_CHAT_ID` — ID чата, куда будут отправляться сообщения
   - `SEND_BALANCE_MESSAGE_AT` — время отправки ежедневного сообщения (формат: `HH:MM:SS`)

4. **Запустите бота**:
```bash
make up
```

5. **Просмотрите логи** (для отслеживания работы бота):
```bash
make logs
```

### Полезные команды

- `make up` — запустить бота
- `make logs` — просмотреть логи
- `make down` — остановить бота
- `make restart` — перезапустить бота
- `make exec` — войти в контейнер
